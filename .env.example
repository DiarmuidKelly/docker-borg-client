# Borg Repository Configuration
# Required: SSH URL to your Borg repository
BORG_REPO=ssh://user@backup-server.example.com:22/~/backups/my-backup

# Required: Repository encryption passphrase
# IMPORTANT: Keep this secure! Without it, you cannot restore your backups.
BORG_PASSPHRASE=your-strong-passphrase-here

# Required: Colon-separated paths to backup (container paths)
# These correspond to the mounted volumes in docker-compose.yml
BACKUP_PATHS=/data/backup1

# Optional: Source directories on host to backup
BACKUP_SOURCE_1=/path/to/your/data
# BACKUP_SOURCE_2=/path/to/more/data

# Optional: Cron schedule for backups (default: Sunday at 2am)
# Format: minute hour day-of-month month day-of-week
# Examples:
#   0 2 * * 0     - Every Sunday at 2am (default)
#   0 3 * * *     - Every day at 3am
#   0 2 * * 1-5   - Weekdays at 2am
#   0 */6 * * *   - Every 6 hours
CRON_SCHEDULE=0 2 * * 0

# Optional: Run backup immediately on container start (default: false)
RUN_ON_START=false

# Optional: Prune retention policy (default values shown)
PRUNE_KEEP_DAILY=7
PRUNE_KEEP_WEEKLY=4
PRUNE_KEEP_MONTHLY=6

# Optional: Timezone for cron jobs (default: UTC)
TZ=Europe/London

# =============================================================================
# TrueNAS Notifications (Optional)
# Requires: TrueNAS SCALE 25.04 or later
# =============================================================================

# Enable TrueNAS API notifications (default: false)
NOTIFY_TRUENAS_ENABLED=false

# TrueNAS WebSocket URL (use your TrueNAS IP address, not localhost)
# Use ws:// for unencrypted connections (recommended for local networks)
# Examples:
#   - Unencrypted:  ws://192.168.1.100
#   - Encrypted:    wss://truenas.local (if you have proper SSL certificates)
NOTIFY_TRUENAS_API_URL=ws://192.168.1.100

# TrueNAS API Key (generate in TrueNAS web UI: Settings -> API Keys)
NOTIFY_TRUENAS_API_KEY=1-abc123yourapikey

# SSL certificate verification for wss:// connections (set to false for self-signed)
# Only applies to wss:// URLs. Default: true
# NOTIFY_TRUENAS_VERIFY_SSL=false

# Which events to notify about (comma-separated list)
# Available events: backup.success, backup.failure, prune.success, prune.failure
# Default: backup.failure,prune.failure (failures only)
NOTIFY_EVENTS=backup.failure,backup.success

# =============================================================================
# Backup Time Window and Rate Limiting (Optional)
# =============================================================================

# Restrict backups to specific time windows (24-hour format HH:MM)
# Leave empty to allow backups at any time
# Examples:
#   - Night window:     BACKUP_WINDOW_START=01:00, BACKUP_WINDOW_END=07:00
#   - Overnight window: BACKUP_WINDOW_START=22:00, BACKUP_WINDOW_END=06:00
#   - Day window:       BACKUP_WINDOW_START=09:00, BACKUP_WINDOW_END=17:00
# BACKUP_WINDOW_START=01:00
# BACKUP_WINDOW_END=07:00

# Rate limit INSIDE the backup window (in Mbps)
# -1  = Unlimited bandwidth (burst speeds, default)
#  0  = Not applicable for inside window (would prevent backups)
# >0  = Limit in Mbps (e.g., 40 = 40 Mbps)
# Default: -1 (unlimited)
# BACKUP_RATE_LIMIT_IN_WINDOW=-1

# Rate limit OUTSIDE the backup window (in Mbps)
# -1  = Unlimited bandwidth (no time restriction)
#  0  = Stopped (no backup outside window, recommended)
# >0  = Limit in Mbps (e.g., 5 = 5 Mbps trickle during day)
# Default: -1 (unlimited)
# BACKUP_RATE_LIMIT_OUT_WINDOW=0

# Example configurations:
#
# 1. Large initial backup on limited connection (40 Mbps):
#    BACKUP_WINDOW_START=01:00
#    BACKUP_WINDOW_END=07:00
#    BACKUP_RATE_LIMIT_IN_WINDOW=-1   # Unlimited overnight
#    BACKUP_RATE_LIMIT_OUT_WINDOW=0   # Stopped during day
#
# 2. Continuous backup with daytime throttle:
#    BACKUP_WINDOW_START=22:00
#    BACKUP_WINDOW_END=08:00
#    BACKUP_RATE_LIMIT_IN_WINDOW=-1   # Unlimited overnight
#    BACKUP_RATE_LIMIT_OUT_WINDOW=5   # 5 Mbps trickle during day
#
# 3. No time restriction (default behavior):
#    # Leave BACKUP_WINDOW_START and BACKUP_WINDOW_END empty
#    BACKUP_RATE_LIMIT_IN_WINDOW=-1
#    BACKUP_RATE_LIMIT_OUT_WINDOW=-1
